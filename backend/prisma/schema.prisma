generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["postgresqlExtensions"]
}

datasource db {
  provider   = "postgresql"
  url        = env("DATABASE_URL")
  directUrl  = env("DIRECT_URL")
  extensions = [uuid_ossp(map: "uuid-ossp")]
}

model categories {
  id           String         @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  name         String         @db.VarChar(50)
  type         String?        @db.VarChar(10)
  family_id    String?        @db.Uuid
  families     families?      @relation(fields: [family_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  transactions transactions[]
}

model families {
  id            String         @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  name          String         @db.VarChar(100)
  created_at    DateTime?      @default(now()) @db.Timestamptz(6)
  categories    categories[]
  transactions  transactions[]
  users         users[]
  password_hash String
}

model transactions {
  id          String      @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  family_id   String?     @db.Uuid
  user_id     String?     @db.Uuid
  description String      @db.VarChar(255)
  amount      Decimal     @db.Decimal(12, 2)
  date        DateTime    @db.Date
  type        String?     @db.VarChar(10)
  category_id String?     @db.Uuid
  created_at  DateTime?   @default(now()) @db.Timestamptz(6)
  categories  categories? @relation(fields: [category_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  families    families?   @relation(fields: [family_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  users       users?      @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  currency_id String
  currency    currencies  @relation(fields: [currency_id], references: [id])
  is_paid     Boolean     @default(false)
  group_id    String?     @db.VarChar(255)

  @@index([group_id])
}

model users {
  id            String         @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  family_id     String?        @db.Uuid
  name          String         @db.VarChar(100)
  email         String         @unique @db.VarChar(255)
  password_hash String
  created_at    DateTime?      @default(now()) @db.Timestamptz(6)
  transactions  transactions[]
  families      families?      @relation(fields: [family_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  is_super_user Boolean        @default(false)
}

model currencies {
  id           String         @id @default(cuid())
  name         String
  symbol       String
  code         String         @unique
  transactions transactions[]
}
